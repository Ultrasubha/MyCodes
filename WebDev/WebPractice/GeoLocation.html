<html>

<head>
	<title>Watching position</title>
	<script src="https://maps.googleapis.com/maps/api/js"></script>
	<script>
		function geoFindMe() {
			var output = document.getElementById("out");
			if (!navigator.geolocation) {
				output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
				return;
			}

			function loadMap(position) {
				var [latitude, longitude] = success(position);
				var mapOptions = {
					center: new google.maps.LatLng(latitude, longitude),
					zoom: 12,
					mapTypeId: google.maps.MapTypeId.ROADMAP
				};

				var map = new google.maps.Map(document.getElementById("sample"), mapOptions);
			}

			function success(position) {
				var latitude = position.coords.latitude;
				var longitude = position.coords.longitude;
				output.innerHTML = '<p>Latitude is ' + latitude + '° <br>Longitude is ' + longitude + '°</p>';
				return [latitude, longitude];
			}

			function error() {
				output.innerHTML = "Unable to retrieve your location";
			}

			output.innerHTML = "<p>Locating…</p>";
			navigator.geolocation.getCurrentPosition(loadMap, error);
		}
	</script>
</head>

<body>
	<p><button onclick="geoFindMe()">Show my location</button></p>
	<div id="out"></div>
	<div id="sample" style="width: 400px; height: 300px;"></div>
</body>
</html>
